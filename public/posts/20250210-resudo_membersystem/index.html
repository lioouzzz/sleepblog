<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/lioouzzz/sleepblog.git/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=lioouzzz/sleepblog.git/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>æ‰“é€ æœƒå“¡ç³»çµ±(å‰å¾Œç«¯åˆ†é›¢) | ğŸ€ğŸ€ğŸ€</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="é€™æ¬¡å°ˆæ¡ˆä½¿ç”¨çš„å·¥å…·
å‰ç«¯ï¼švite&#43;React
å¾Œç«¯ï¼šdjango
è³‡æ–™åº«ï¼šMySQL">
    <meta name="generator" content="Hugo 0.138.0">
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    
      <meta name="author" content = "Elaine Liu">
    

    
<link rel="stylesheet" href="/lioouzzz/sleepblog.git/ananke/css/main.min.css" >



  
    <link rel="stylesheet" href="/lioouzzz/sleepblog.git/css/custom.css">
  

    

    
      
<link rel="shortcut icon" href="/lioouzzz/sleepblog.git/images/20241130%20%e5%80%8b%e4%ba%balogo2.png" type="image/x-icon" />


    

    

    
      <link rel="canonical" href="http://localhost:1313/lioouzzz/sleepblog.git/posts/20250210-resudo_membersystem/">
    

    <meta property="og:url" content="http://localhost:1313/lioouzzz/sleepblog.git/posts/20250210-resudo_membersystem/">
  <meta property="og:site_name" content="ğŸ€ğŸ€ğŸ€">
  <meta property="og:title" content="æ‰“é€ æœƒå“¡ç³»çµ±(å‰å¾Œç«¯åˆ†é›¢)">
  <meta property="og:description" content="é€™æ¬¡å°ˆæ¡ˆä½¿ç”¨çš„å·¥å…·
å‰ç«¯ï¼švite&#43;React
å¾Œç«¯ï¼šdjango
è³‡æ–™åº«ï¼šMySQL">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-02-09T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-02-09T00:00:00+00:00">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="Vite&#43;React">
    <meta property="article:tag" content="API">
    <meta property="article:tag" content="DRF">

  <meta itemprop="name" content="æ‰“é€ æœƒå“¡ç³»çµ±(å‰å¾Œç«¯åˆ†é›¢)">
  <meta itemprop="description" content="é€™æ¬¡å°ˆæ¡ˆä½¿ç”¨çš„å·¥å…·
å‰ç«¯ï¼švite&#43;React
å¾Œç«¯ï¼šdjango
è³‡æ–™åº«ï¼šMySQL">
  <meta itemprop="datePublished" content="2025-02-09T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-02-09T00:00:00+00:00">
  <meta itemprop="wordCount" content="1257">
  <meta itemprop="keywords" content="Python,Vite&#43;React,API,DRF">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="æ‰“é€ æœƒå“¡ç³»çµ±(å‰å¾Œç«¯åˆ†é›¢)">
  <meta name="twitter:description" content="é€™æ¬¡å°ˆæ¡ˆä½¿ç”¨çš„å·¥å…·
å‰ç«¯ï¼švite&#43;React
å¾Œç«¯ï¼šdjango
è³‡æ–™åº«ï¼šMySQL">

	
  <script src="/lioouzzz/sleepblog.git/js/search.js"></script>
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  
  
  
  <header class="cover bg-center" style="background-image: url('http://localhost:1313/lioouzzz/sleepblog.git/images/sunnyday.png');">
    <div class="bg-black-60">
      <nav class="pv3 ph3 ph4-ns bg-white" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a
      href="/lioouzzz/sleepblog.git/"
      class="f3 fw2 hover-blue no-underline dark-blue dib"
    >
      
      <img src="/lioouzzz/sleepblog.git/images/20241130%20%e5%80%8b%e4%ba%balogo2.png" class="w100 mw5-ns" alt="ğŸ€ğŸ€ğŸ€" />
      
    </a>

    <div class="flex-l items-center">
      <div class="relative mr2">
    <input type="search" 
      class="pa2 br2 ba b--custom-blue" 
      placeholder="æœå°‹..." 
      id="search-input"
      onkeyup="search()">
  </div> 
      <ul class="pl0 mr3">
         
        <li class="list f5 f4-ns fw4 dib mr3">
          <a href="/lioouzzz/sleepblog.git/" class="hover-blue no-underline dark-blue">
            é¦–é 
          </a>
        </li>
          
        <li class="list f5 f4-ns fw4 dib mr3">
          <a href="/lioouzzz/sleepblog.git/posts/" class="hover-blue no-underline dark-blue">
            å…¨éƒ¨æ–‡ç« 
          </a>
        </li>
          
        <li class="list f5 f4-ns fw4 dib mr3 dropdown">
          <a
            href="/lioouzzz/sleepblog.git/categories/"
            class="hover-blue no-underline dark-blue dropdown-toggle"
          >
            æ–‡ç« åˆ†é¡
          </a>
          <ul class="dropdown-menu">
             
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/categories/database/">
                database (3)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/categories/javascripts/">
                javascripts (5)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/categories/python/">
                python (8)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/categories/%E5%89%8D%E7%AB%AF/">
                å‰ç«¯ (1)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/categories/%E5%BE%8C%E7%AB%AF/">
                å¾Œç«¯ (2)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/categories/%E7%B6%B2%E8%B7%AF%E5%AE%89%E5%85%A8/">
                ç¶²è·¯å®‰å…¨ (1)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/categories/%E8%B3%87%E5%AE%89/">
                è³‡å®‰ (3)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/categories/%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B/">
                è³‡æ–™çµæ§‹ (1)
              </a>
            </li>
             
          </ul>
        </li>
          
        <li class="list f5 f4-ns fw4 dib mr3 dropdown">
          <a
            href="/lioouzzz/sleepblog.git/tags/"
            class="hover-blue no-underline dark-blue dropdown-toggle"
          >
            æ–‡ç« æ¨™ç±¤
          </a>
          <ul class="dropdown-menu">
             
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/tags/api/">
                api (1)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/tags/aws/">
                aws (1)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/tags/database/">
                database (2)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/tags/django/">
                django (4)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/tags/drf/">
                drf (1)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/tags/js/">
                js (5)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/tags/python/">
                python (9)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/tags/vite&#43;react/">
                vite&#43;react (1)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/tags/%E5%89%8D%E7%AB%AF/">
                å‰ç«¯ (6)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/tags/%E5%BE%8C%E7%AB%AF/">
                å¾Œç«¯ (13)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/tags/%E8%B3%87%E5%AE%89/">
                è³‡å®‰ (1)
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/lioouzzz/sleepblog.git/tags/%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B/">
                è³‡æ–™çµæ§‹ (1)
              </a>
            </li>
             
          </ul>
        </li>
         
      </ul>
      
    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <div class="f2 f1-l fw2 white-90 mb0 lh-title">æ‰“é€ æœƒå“¡ç³»çµ±(å‰å¾Œç«¯åˆ†é›¢)</div>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      


  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">æ‰“é€ æœƒå“¡ç³»çµ±(å‰å¾Œç«¯åˆ†é›¢)</h1>
      
      <p class="tracked">
        By <strong>Elaine Liu</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2025-02-09T00:00:00Z">2025å¹´2æœˆ9æ—¥</time>
      

      
      
        <span class="f6 mv4 dib tracked"> - 6 minutes read </span>
        <span class="f6 mv4 dib tracked"> - 1257 words </span>
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>é€™æ¬¡å°ˆæ¡ˆä½¿ç”¨çš„å·¥å…·<br>
å‰ç«¯ï¼š<code>vite+React</code><br>
å¾Œç«¯ï¼š<code>django</code><br>
è³‡æ–™åº«ï¼š<code>MySQL</code></p>
<h3 id="å¾Œç«¯å»ºç«‹-api">å¾Œç«¯å»ºç«‹ API</h3>
<p>é¦–å…ˆå»ºç«‹ä¸€å€‹æ‡‰ç”¨ç¨‹å¼ app <code>users</code></p>
<pre tabindex="0"><code>python manage.py startapp users
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>INSTALLED_APPS <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.admin&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.auth&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.contenttypes&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.sessions&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.messages&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.staticfiles&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;corsheaders&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;users&#34;</span>,  <span style="color:#75715e">#åŠ å…¥&#34;users&#34;åˆ°é€™å€‹INSTALLED_APPS</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;profiles&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;drf_yasg&#39;</span>,
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>CORS_ALLOW_CREDENTIALS <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span></code></pre></div><p>åœ¨é€™è£¡ä»‹ç´¹ä¸€ä¸‹ï¼Œåºåˆ—å™¨ã€‚<br>
å¯ä»¥æŠŠè³‡æ–™åœ¨ä¸åŒæ ¼å¼è½‰æ›æ ¼å¼ï¼Œåœ¨ API é–‹ç™¼å’Œæ•¸æ“šå­˜å„²æ™‚å¾ˆå¸¸è¦‹ã€‚</p>
<p>åºåˆ—åŒ–æ˜¯æŠŠç‰©ä»¶(Object)è½‰æ›ç‚º JSONã€XMLã€äºŒé€²ä½æ ¼å¼ï¼Œæ–¹ä¾¿å‚³è¼¸å’Œå„²å­˜ï¼Œåœ¨å¾Œç«¯é–‹ç™¼æ™‚ï¼Œé€šå¸¸éœ€è¦æŠŠ Python ç‰©ä»¶(Django)æ¨¡å‹è½‰æ›ç‚º JSON æ ¼å¼ï¼Œè®“å‰ç«¯è®€å–ã€‚</p>
<p>ä¸‹ä¸€æ­¥æˆ‘å€‘å°±é–‹å§‹ä¾†ç·¨å¯«åºåˆ—å™¨ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PY" data-lang="PY"><span style="display:flex;"><span><span style="color:#f92672">from</span> django.contrib.auth.models <span style="color:#f92672">import</span> User <span style="color:#75715e">#åŒ¯å…¥Djangoå…§å»ºæ¨¡å‹ï¼Œç®¡ç†ä½¿ç”¨è€…å¸³è™Ÿ</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rest_framework <span style="color:#f92672">import</span> serializers <span style="color:#75715e">#serializers ä¾†è‡ª Django REST Frameworkã€‚æä¾›äº†`ModelSerializer`ä¾†ç°¡åŒ–Modelåˆ°Jsonä¹‹é–“çš„è½‰æ›</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserSerializer</span>(serializers<span style="color:#f92672">.</span>ModelSerializer):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#å®šç¾©UserSerializerï¼Œé€™å€‹åºåˆ—åŒ–å™¨ç¹¼æ‰¿æ–¼serializers.ModleSerializerï¼Œè¡¨ç¤ºå®ƒæ˜¯åŸºæ–¼Django Model è‡ªå‹•ç”Ÿæˆçš„åºåˆ—åŒ–å™¨</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Meta</span>:
</span></span><span style="display:flex;"><span>        model <span style="color:#f92672">=</span> User
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#åºåˆ—åŒ–å™¨å°æ‡‰çš„Django Useræ¨¡å‹</span>
</span></span><span style="display:flex;"><span>        fields <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#34;username&#34;</span>, <span style="color:#e6db74">&#34;email&#34;</span>, <span style="color:#e6db74">&#34;password&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#åºåˆ—åŒ–æ™‚è¦åŒ…å«çš„æ¬„ä½</span>
</span></span><span style="display:flex;"><span>        extra_kwargs <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;password&#39;</span>: {<span style="color:#e6db74">&#39;write_only&#39;</span>: <span style="color:#66d9ef">True</span>},
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;email&#39;</span>: {<span style="color:#e6db74">&#39;required&#39;</span>: <span style="color:#66d9ef">True</span>}}
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#é¡å¤–åƒæ•¸è¨­å®šï¼Œå¯†ç¢¼æ¬„ä½åªèƒ½å¯«å…¥ï¼Œä¸èƒ½è®€å–ï¼Œé€™æ¨£åœ¨API RESPONSEä¸­ä¸æœƒé¡¯ç¤ºå¯†ç¢¼ã€‚ emailæ˜¯å¿…å¡«</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create</span>(self, validated_data):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#create()è² è²¬ååºåˆ—åŒ–JSONä¸¦å‰µç«‹Userå¯¦ä¾‹</span>
</span></span><span style="display:flex;"><span>        user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(
</span></span><span style="display:flex;"><span>            username<span style="color:#f92672">=</span>validated_data[<span style="color:#e6db74">&#39;username&#39;</span>],
</span></span><span style="display:flex;"><span>            email<span style="color:#f92672">=</span>validated_data[<span style="color:#e6db74">&#39;email&#39;</span>],
</span></span><span style="display:flex;"><span>            password<span style="color:#f92672">=</span>validated_data[<span style="color:#e6db74">&#39;password&#39;</span>],
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#ä½¿ç”¨User.objects.create_user()ï¼Œcreate_user()æœƒè‡ªå‹•åŠ å¯†å¯†ç¢¼ï¼Œå¦‚æœæ˜¯ç”¨   ser.objects.create()ï¼Œä¸æœƒåŠ å¯†ï¼Œå¯†ç¢¼åªæœƒç”¨ç´”æ–‡å­—ï¼Œé€™æ¨£ä¸å®‰å…¨ã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#validate_dataè¡¨ç¤ºå·²é©—è­‰çš„è³‡æ–™</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> user
</span></span></code></pre></div><p>å†ä¾†ï¼Œåˆ° users/urls.py å»å®šç¾©è·¯ç”±</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> django.urls <span style="color:#f92672">import</span> path
</span></span><span style="display:flex;"><span>form <span style="color:#f92672">.</span>views <span style="color:#f92672">import</span> user_register<span style="color:#f92672">,</span>user_login<span style="color:#f92672">,</span>user_logout
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app_names<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;users&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>urlpatterns<span style="color:#f92672">=</span>[
</span></span><span style="display:flex;"><span>    path(<span style="color:#e6db74">&#34;register/&#34;</span>,user_register,name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;user_register&#34;</span>),
</span></span><span style="display:flex;"><span>    path(<span style="color:#e6db74">&#34;login/&#34;</span>,user_login,name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;user_login&#34;</span>),
</span></span><span style="display:flex;"><span>    path(<span style="color:#e6db74">&#34;logout/&#34;</span>,user_logout,name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;user_logout&#34;</span>),
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p>åˆ° views.py å»æ§åˆ¶åˆ¤æ–·è«‹æ±‚å›æ‡‰</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> django.shortcuts <span style="color:#f92672">import</span> render
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rest_framework.decroators <span style="color:#f92672">import</span> api_view
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rest_framework.response <span style="color:#f92672">import</span> Response
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> django.contrib.auth <span style="color:#f92672">import</span> authenticate,login,logout
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> .serializers <span style="color:#f92672">import</span> UserSerializer
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@api_view</span>([POST])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">user_register</span>(request):
</span></span><span style="display:flex;"><span>    serializer<span style="color:#f92672">=</span>UserSerializer(data<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>data)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> serializer<span style="color:#f92672">.</span>is_valid():
</span></span><span style="display:flex;"><span>        serializer<span style="color:#f92672">.</span>save()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Response({<span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;è¨»å†ŠæˆåŠŸ&#34;</span>},status<span style="color:#f92672">=</span>status<span style="color:#f92672">.</span>HTTP_201_CREATED)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Response({<span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;è¨»å†Šå¤±æ•—&#34;</span>},status<span style="color:#f92672">=</span>status<span style="color:#f92672">.</span>HTTP_400_BAD_REQUEST)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@api_view</span>([POST])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">user_login</span>(request):
</span></span><span style="display:flex;"><span>    username<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>data<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;username&#34;</span>)
</span></span><span style="display:flex;"><span>    password<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>data<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;password&#34;</span>)
</span></span><span style="display:flex;"><span>    email<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>data<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;email&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    user<span style="color:#f92672">=</span>authenticate(request,username<span style="color:#f92672">=</span>username,passowrd<span style="color:#f92672">=</span>password)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> user <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>        login(request,user)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Response({<span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;ç™»å…¥æˆåŠŸ&#34;</span>},status<span style="color:#f92672">=</span>status<span style="color:#f92672">.</span>HTTP_200_OK)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Response({<span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;ç™»å…¥å¤±æ•—&#34;</span>},status<span style="color:#f92672">=</span>status<span style="color:#f92672">.</span>HTTP_400_BAD_REQUEST)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@api_view</span>([POST])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">user_logout</span>(request):
</span></span><span style="display:flex;"><span>    logout(request)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Response({message:<span style="color:#e6db74">&#34;ç™»å‡ºæˆåŠŸ&#34;</span>},status<span style="color:#f92672">=</span>status<span style="color:#f92672">.</span>HTTP_200_OK)
</span></span></code></pre></div><h3 id="å‰ç«¯ä¸²æ¥-api">å‰ç«¯ä¸²æ¥ API</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#75715e">// src/App.jsx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Routes</span>, <span style="color:#a6e22e">Route</span>, <span style="color:#a6e22e">Link</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react-router-dom&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Home</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./components/Home&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">ProfileIndex</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./components/profiles/ProfileIndex&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">ProfileShow</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./components/profiles/ProfileShow&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">ProfileNew</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./components/profiles/ProfileNew&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">ProfileEdit</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./components/profiles/ProfileEdit&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Register</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./components/auth/Register&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Login</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./components/auth/Login&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#39;./App.css&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">App</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> (
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">nav</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">Link</span> <span style="color:#a6e22e">to</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/register&#34;</span>&gt;<span style="color:#a6e22e">Register</span>&lt;/<span style="color:#f92672">Link</span>&gt; <span style="color:#f92672">|</span> &lt;<span style="color:#f92672">Link</span> <span style="color:#a6e22e">to</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/login&#34;</span>&gt;<span style="color:#a6e22e">Login</span>&lt;/<span style="color:#f92672">Link</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">nav</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">Routes</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">Route</span> <span style="color:#a6e22e">path</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#a6e22e">element</span><span style="color:#f92672">=</span>{&lt;<span style="color:#f92672">Home</span> /&gt;} /&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">Route</span> <span style="color:#a6e22e">path</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;register&#34;</span> <span style="color:#a6e22e">element</span><span style="color:#f92672">=</span>{&lt;<span style="color:#f92672">Register</span> /&gt;} /&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">Route</span> <span style="color:#a6e22e">path</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/login&#34;</span> <span style="color:#a6e22e">element</span><span style="color:#f92672">=</span>{&lt;<span style="color:#f92672">Login</span> /&gt;} /&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">Route</span> <span style="color:#a6e22e">path</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/profiles&#34;</span> <span style="color:#a6e22e">element</span><span style="color:#f92672">=</span>{&lt;<span style="color:#f92672">ProfileIndex</span> /&gt;} /&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">Route</span> <span style="color:#a6e22e">path</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/profiles/:id&#34;</span> <span style="color:#a6e22e">element</span><span style="color:#f92672">=</span>{&lt;<span style="color:#f92672">ProfileShow</span> /&gt;} /&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">Route</span> <span style="color:#a6e22e">path</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/profiles/new&#34;</span> <span style="color:#a6e22e">element</span><span style="color:#f92672">=</span>{&lt;<span style="color:#f92672">ProfileNew</span> /&gt;} /&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">Route</span> <span style="color:#a6e22e">path</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/profiles/edit/:id&#34;</span> <span style="color:#a6e22e">element</span><span style="color:#f92672">=</span>{&lt;<span style="color:#f92672">ProfileEdit</span> /&gt;} /&gt;
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">Routes</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#75715e">// src/components/Home.jsx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Link</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react-router-dom&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Home</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">setMessage</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handleLogout</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;http://localhost:8000/api/users/logout/&#39;</span>, {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;POST&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>      })
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">json</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">ok</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">message</span>)
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">error</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39;ç™»å‡ºå¤±æ•—&#39;</span>)
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">setMessage</span>(<span style="color:#e6db74">&#39;ç™¼ç”ŸéŒ¯èª¤&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> (
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">h2</span>&gt;<span style="color:#a6e22e">æ­¡è¿ä¾†åˆ°é¦–é </span>&lt;/<span style="color:#f92672">h2</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">Link</span> <span style="color:#a6e22e">to</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/profiles/new&#34;</span>&gt;<span style="color:#a6e22e">å»ºç«‹æ–°</span> <span style="color:#a6e22e">Profile</span>&lt;/<span style="color:#f92672">Link</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">li</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">onClick</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">handleLogout</span>}&gt;<span style="color:#a6e22e">ç™»å‡º</span>&lt;/<span style="color:#f92672">button</span>&gt;
</span></span><span style="display:flex;"><span>      {<span style="color:#a6e22e">message</span> <span style="color:#f92672">&amp;&amp;</span> &lt;<span style="color:#f92672">p</span>&gt;{<span style="color:#a6e22e">message</span>}&lt;/<span style="color:#f92672">p</span>&gt;}
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#75715e">// auth/Login.jsx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Login</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">username</span>, <span style="color:#a6e22e">setUsername</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">password</span>, <span style="color:#a6e22e">setPassword</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">setMessage</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handleLogin</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">preventDefault</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;http://localhost:8000/api/users/login/&#39;</span>, {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;POST&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#a6e22e">username</span>, <span style="color:#a6e22e">password</span> }),
</span></span><span style="display:flex;"><span>      })
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">json</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">ok</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setTimeout</span>(() =&gt; {
</span></span><span style="display:flex;"><span>          window.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">href</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/&#39;</span>
</span></span><span style="display:flex;"><span>        }, <span style="color:#ae81ff">800</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">message</span>)
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">data</span>))
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">setMessage</span>(<span style="color:#e6db74">&#39;ç™¼ç”ŸéŒ¯èª¤&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> (
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">h2</span>&gt;<span style="color:#a6e22e">Login</span>&lt;/<span style="color:#f92672">h2</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">form</span> <span style="color:#a6e22e">onSubmit</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">handleLogin</span>}&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">label</span>&gt;<span style="color:#a6e22e">Username</span><span style="color:#f92672">:</span> &lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">input</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">username</span>}
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{(<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">setUsername</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">value</span>)}
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">required</span>
</span></span><span style="display:flex;"><span>          /&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">label</span>&gt;<span style="color:#a6e22e">Password</span><span style="color:#f92672">:</span> &lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">input</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;password&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">password</span>}
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{(<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">setPassword</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">value</span>)}
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">required</span>
</span></span><span style="display:flex;"><span>          /&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span>&gt;<span style="color:#a6e22e">Login</span>&lt;/<span style="color:#f92672">button</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>      {<span style="color:#a6e22e">message</span> <span style="color:#f92672">&amp;&amp;</span> &lt;<span style="color:#f92672">p</span>&gt;{<span style="color:#a6e22e">message</span>}&lt;/<span style="color:#f92672">p</span>&gt;}
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">Login</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#75715e">// src/components/auth/Register.jsx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">useNavigate</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react-router-dom&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Register</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">username</span>, <span style="color:#a6e22e">setUsername</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">email</span>, <span style="color:#a6e22e">setEmail</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">password</span>, <span style="color:#a6e22e">setPassword</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">setMessage</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">navigate</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">useNavigate</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handleRegister</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">preventDefault</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payload</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">username</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">email</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">password</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;http://localhost:8000/api/users/register/&#39;</span>,
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;POST&#39;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span>,
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">payload</span>),
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">json</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">ok</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#e6db74">&#39;è¨»å†ŠæˆåŠŸ&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setTimeout</span>(() =&gt; {
</span></span><span style="display:flex;"><span>          window.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">href</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/&#39;</span>
</span></span><span style="display:flex;"><span>        }, <span style="color:#ae81ff">800</span>)
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#e6db74">&#39;è¨»å†Šå¤±æ•—&#39;</span>, <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">data</span>))
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">setMessage</span>(<span style="color:#e6db74">&#39;ç™¼ç”ŸéŒ¯èª¤&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> (
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">h2</span>&gt;<span style="color:#a6e22e">è¨»å†Š</span>&lt;/<span style="color:#f92672">h2</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">form</span> <span style="color:#a6e22e">onSubmit</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">handleRegister</span>}&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">label</span>&gt;<span style="color:#a6e22e">ä½¿ç”¨è€…åç¨±</span>&lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">input</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">username</span>}
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{(<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">setUsername</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">value</span>)}
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">required</span>
</span></span><span style="display:flex;"><span>          /&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">label</span>&gt;<span style="color:#a6e22e">Email</span><span style="color:#f92672">:</span> &lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">input</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;email&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">email</span>}
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{(<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">setEmail</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">value</span>)}
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">required</span>
</span></span><span style="display:flex;"><span>          /&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">label</span>&gt;<span style="color:#a6e22e">å¯†ç¢¼</span>&lt;/<span style="color:#f92672">label</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#f92672">input</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;password&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">password</span>}
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">onChange</span><span style="color:#f92672">=</span>{(<span style="color:#a6e22e">e</span>) =&gt; <span style="color:#a6e22e">setPassword</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">target</span>.<span style="color:#a6e22e">value</span>)}
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">required</span>
</span></span><span style="display:flex;"><span>          /&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span>&gt;<span style="color:#a6e22e">è¨»å†Š</span>&lt;/<span style="color:#f92672">button</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>      {<span style="color:#a6e22e">message</span> <span style="color:#f92672">&amp;&amp;</span> &lt;<span style="color:#f92672">p</span>&gt;{<span style="color:#a6e22e">message</span>}&lt;/<span style="color:#f92672">p</span>&gt;}
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">Register</span>
</span></span></code></pre></div><h3 id="å¢åŠ -jwt-èªè­‰">å¢åŠ  JWT èªè­‰</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PY" data-lang="PY"><span style="display:flex;"><span><span style="color:#f92672">from</span> pathlib <span style="color:#f92672">import</span> Path
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> environ
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> timedelta <span style="color:#75715e"># åŒ¯å…¥é€™å€‹æ¨¡çµ„</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> dotenv <span style="color:#f92672">import</span> load_dotenv
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>INSTALLED_APPS <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.admin&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.auth&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.contenttypes&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.sessions&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.messages&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.staticfiles&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;corsheaders&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;rest_framework&#34;</span>,  <span style="color:#75715e">#åŠ ä¸Šé€™å€‹</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;users&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;profiles&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;drf_yasg&#39;</span>,
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>REST_FRAMEWORK <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;DEFAULT_AUTHENTICATION_CLASSES&#39;</span>: (
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;rest_framework_simplejwt.authentication.JWTAuthentication&#39;</span>,
</span></span><span style="display:flex;"><span>    ),  <span style="color:#75715e">#APIç«¯é»èº«åˆ†é©—è­‰æ–¹æ˜¯ç”¨simplejwtå¥—ä»¶</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;DEFAULT_PERMISSION_CLASSES&#39;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;rest_framework.permissions.IsAuthenticated&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#æ‰€æœ‰ç«¯é»éƒ½è¦ç™»å…¥æ‰èƒ½å­˜å–</span>
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SIMPLE_JWT <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;ACCESS_TOKEN_LIFETIME&#39;</span>: timedelta(minutes<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>), <span style="color:#75715e">#å­˜å–æ¬Šæ–çš„æ™‚é–“</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;REFRESH_TOKEN_LIFETIME&#39;</span>: timedelta(days<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>), <span style="color:#75715e">#åˆ·æ–°æ¬Šæ–ï¼Œæœ‰æ•ˆæ˜¯ä¸€å¤©</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;AUTH_HEADER_TYPES&#39;</span>: (<span style="color:#e6db74">&#39;Bearer&#39;</span>,), <span style="color:#75715e">#æˆæ¬Šæ¨™é ­ï¼Œè«‹æ±‚APIæ™‚è¦åŠ ä¸Šçš„æ¨™é ­ï¼Œç”¨&#34;Bearer&#34;ä½œç‚ºå‰ç¶´</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#æ¯æ¬¡è«‹æ±‚APIï¼Œéƒ½è¦æä¾›Access Tokenï¼ŒAccess Token éæœŸå¾Œï¼Œæœƒä½¿ç”¨Refresh Tokenä¾†æ›å–Access Tokenï¼Œå¦‚æ­¤ä¸€ä¾†ä½¿ç”¨è€…å¯ä»¥ç”¨Refresh Token å–å¾—æœ€æ–°çš„Access Tokenï¼Œè€Œä¸éœ€è¦é‡æ–°ç™»å…¥ï¼Œå¯ä»¥æ¸›å°‘é »ç¹è¼¸å…¥å¯†ç¢¼çš„éœ€æ±‚ã€‚</span>
</span></span></code></pre></div><p>åœ¨ä¸»ç¨‹å¼çš„ urls.py æ·»åŠ  token è·¯ç”±</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># core/urls.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> django.contrib <span style="color:#f92672">import</span> admin
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> django.urls <span style="color:#f92672">import</span> path,include
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rest_framework_simplejwt.views <span style="color:#f92672">import</span> TokenObtainPairView,TokenRefreshView
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rest_framework <span style="color:#f92672">import</span> permissions
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>path(<span style="color:#e6db74">&#39;api/token/&#39;</span>,TokenObtainPairView<span style="color:#f92672">.</span>as_view(),name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;token_obtain_pair&#39;</span>)
</span></span><span style="display:flex;"><span>path(<span style="color:#e6db74">&#39;api/token/refresh/&#39;</span>,TokenRefreshView<span style="color:#f92672">.</span>as_view(),name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;token_refresh&#39;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># users/views.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rest_framework.decorators <span style="color:#f92672">import</span> api_view,permission_classes
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rest_framework_simplejwt.tokens <span style="color:#f92672">import</span> RefreshToken
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rest_framework.permissions <span style="color:#f92672">import</span> AllowAny, IsAuthenticated
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@api_view</span>([<span style="color:#e6db74">&#34;POST&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">user_register</span>(request):
</span></span><span style="display:flex;"><span>  serializer<span style="color:#f92672">=</span>UserSerializer(data<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>data)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> serializer<span style="color:#f92672">.</span>is_valid(){
</span></span><span style="display:flex;"><span>    user<span style="color:#f92672">=</span>serializer<span style="color:#f92672">.</span>save()
</span></span><span style="display:flex;"><span>    refresh<span style="color:#f92672">=</span>RefreshToken<span style="color:#f92672">.</span>for_user(user)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Response({<span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;è¨»å†ŠæˆåŠŸ&#34;</span>,<span style="color:#e6db74">&#34;access&#34;</span>:str(refresh<span style="color:#f92672">.</span>access_token),<span style="color:#e6db74">&#34;refresh&#34;</span>:str(refresh)<span style="color:#f92672">.</span>status<span style="color:#f92672">=</span>status<span style="color:#f92672">.</span>HTTP_201_CREATED})
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> Response(serializer<span style="color:#f92672">.</span>errors,status<span style="color:#f92672">=</span>status<span style="color:#f92672">.</span>HTTP_400_BAD_REQUEST)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@api_view</span>([<span style="color:#e6db74">&#34;POST&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@permission_classes</span>([AllowAny])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">user_login</span>(request):
</span></span><span style="display:flex;"><span>  username<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>data<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;username&#34;</span>)
</span></span><span style="display:flex;"><span>  password<span style="color:#f92672">=</span>request<span style="color:#f92672">.</span>data<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;password&#34;</span>)
</span></span><span style="display:flex;"><span>  user<span style="color:#f92672">=</span>authenticate(request,username<span style="color:#f92672">=</span>username,password<span style="color:#f92672">=</span>password)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> user <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>        refresh <span style="color:#f92672">=</span> RefreshToken<span style="color:#f92672">.</span>for_user(user) <span style="color:#75715e">#å‰µå»ºJWT Token</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Response({<span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;ç™»å…¥æˆåŠŸ&#34;</span>,<span style="color:#e6db74">&#34;access&#34;</span>:str(refresh<span style="color:#f92672">.</span>access_token),<span style="color:#e6db74">&#34;refresh&#34;</span>:str(refresh)},status<span style="color:#f92672">=</span>status<span style="color:#f92672">.</span>HTTP_200_OK)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Response({<span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;ç™»å…¥å¤±æ•—&#34;</span>},status<span style="color:#f92672">=</span>status<span style="color:#f92672">.</span>HTTP_400_BAD_REQUEST)
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># refresh.access_token:å–å¾—AccessToken(30åˆ†å…§)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#refresh:å–å¾—Refresh Token</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@api_view</span>([<span style="color:#e6db74">&#34;POST&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@permission_classes</span>([AllowAny])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">user_logout</span>(request):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Response({<span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;ç™»å‡ºæˆåŠŸ&#34;</span>},status<span style="color:#f92672">=</span>status<span style="color:#f92672">.</span>HTTP_200_OK)
</span></span></code></pre></div><h3 id="å‰ç«¯-token-è¨­ç½®">å‰ç«¯ token è¨­ç½®</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#75715e">// components&gt;auth&gt;Register.jsx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">useNavigate</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react-router-dom&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Register</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">username</span>, <span style="color:#a6e22e">setUsername</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">email</span>, <span style="color:#a6e22e">setEmail</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">password</span>, <span style="color:#a6e22e">setPassword</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">setMessage</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">navigate</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">useNavigate</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handleRegister</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">preventDefault</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payload</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">username</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">email</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">password</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;http://localhost:8000/api/users/register/&#39;</span>,
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;POST&#39;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span>,
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">payload</span>),
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">json</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">ok</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#e6db74">&#39;è¨»å†ŠæˆåŠŸ&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">localStorage</span>.<span style="color:#a6e22e">setItem</span>(<span style="color:#e6db74">&#39;accessToken&#39;</span>, <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">access</span>) <span style="color:#75715e">//é€™æ˜¯ä¸€å€‹ ç€è¦½å™¨çš„ Web APIï¼Œç”¨ä¾†å„²å­˜è³‡æ–™åœ¨ localStorageï¼Œå³ä½¿ä½¿ç”¨è€…åˆ·æ–°é é¢ï¼Œè³‡æ–™ä¹Ÿä¸æœƒæ¶ˆå¤±ã€‚data.accessï¼šé€™æ˜¯å¾å¾Œç«¯ API å›æ‡‰ä¸­å–å¾—çš„ Access Tokenã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">localStorage</span>.<span style="color:#a6e22e">setItem</span>(<span style="color:#e6db74">&#39;refreshToken&#39;</span>, <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">refresh</span>) <span style="color:#75715e">//data.refreshï¼šé€™æ˜¯å¾å¾Œç«¯ API å›æ‡‰ä¸­å–å¾—çš„ Refresh Tokenã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">setTimeout</span>(() =&gt; {
</span></span><span style="display:flex;"><span>          window.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">href</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/&#39;</span>
</span></span><span style="display:flex;"><span>        }, <span style="color:#ae81ff">800</span>)
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#e6db74">&#39;è¨»å†Šå¤±æ•—&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">data</span>))
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">setMessage</span>(<span style="color:#e6db74">&#39;ç™¼ç”ŸéŒ¯èª¤&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">Register</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#75715e">//components&gt;auth&gt;Login.jsx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Login</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">username</span>, <span style="color:#a6e22e">setUsername</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">password</span>, <span style="color:#a6e22e">setPassword</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">setMessage</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handleLogin</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">preventDefault</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;http://localhost:8000/api/users/login/&#39;</span>, {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;POST&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>({ <span style="color:#a6e22e">username</span>, <span style="color:#a6e22e">password</span> }),
</span></span><span style="display:flex;"><span>      })
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">json</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">ok</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">localStorage</span>.<span style="color:#a6e22e">setItem</span>(<span style="color:#e6db74">&#39;accessToken&#39;</span>, <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">access</span>) <span style="color:#75715e">//è¨­å®šé€™å€‹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">localStorage</span>.<span style="color:#a6e22e">setItem</span>(<span style="color:#e6db74">&#39;refreshToken&#39;</span>, <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">refresh</span>) <span style="color:#75715e">//è¨­å®šé€™å€‹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#e6db74">&#39;ç™»å…¥æˆåŠŸ!&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setTimeout</span>(() =&gt; {
</span></span><span style="display:flex;"><span>          window.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">href</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/&#39;</span>
</span></span><span style="display:flex;"><span>        }, <span style="color:#ae81ff">800</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">message</span>)
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">data</span>))
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">setMessage</span>(<span style="color:#e6db74">&#39;ç™¼ç”ŸéŒ¯èª¤&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">Login</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#75715e">//components&gt;Home.jsx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">React</span>, { <span style="color:#a6e22e">useState</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Link</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;react-router-dom&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Home</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">setMessage</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handleLogout</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">token</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">localStorage</span>.<span style="color:#a6e22e">getItem</span>(<span style="color:#e6db74">&#39;accessToken&#39;</span>) <span style="color:#75715e">//å¾ localStorage å–å‡º JWT Access Tokenï¼Œç”¨ä¾†é€²è¡Œ API è«‹æ±‚æ™‚çš„èº«ä»½é©—è­‰ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;http://localhost:8000/api/users/logout/&#39;</span>, {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;POST&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span>, <span style="color:#75715e">//æŒ‡å®šè«‹æ±‚çš„å…§å®¹é¡å‹æ˜¯ JSON æ ¼å¼ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          <span style="color:#a6e22e">Authorization</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Bearer </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">token</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>, <span style="color:#75715e">// ä½¿ç”¨ JWT Token ä¾†é©—è­‰èº«ä»½ã€‚Bearer æ˜¯ HTTP æˆæ¬Šæ¨™é ­ (Authorization Header) çš„æ¨™æº–æ ¼å¼ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        },
</span></span><span style="display:flex;"><span>      })
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">json</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">ok</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">message</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">localStorage</span>.<span style="color:#a6e22e">removeItem</span>(<span style="color:#e6db74">&#39;accessToken&#39;</span>) <span style="color:#75715e">//å¾ localStorageç§»é™¤ accessToken,ç¢ºä¿ç”¨æˆ¶ç™»å‡ºå¾Œï¼Œå‰ç«¯ä¸æœƒå†è‡ªå‹•å¸¶ä¸Š Tokenã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">localStorage</span>.<span style="color:#a6e22e">removeItem</span>(<span style="color:#e6db74">&#39;refreshToken&#39;</span>) <span style="color:#75715e">//å¾ localStorageç§»é™¤ refreshTokenï¼Œï¼Œé¿å…ç”¨æˆ¶å¯ä»¥ç¹¼çºŒä½¿ç”¨ refreshToken ä¾†æ›å–æ–°çš„ accessToken
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#e6db74">&#39;ç™»å‡ºæˆåŠŸ&#39;</span>)
</span></span><span style="display:flex;"><span>        window.<span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">href</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/login&#39;</span>
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">setMessage</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">error</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39;ç™»å‡ºå¤±æ•—&#39;</span>)
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">setMessage</span>(<span style="color:#e6db74">&#39;ç™¼ç”ŸéŒ¯èª¤&#39;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">Home</span>
</span></span></code></pre></div><h3 id="å—ä¿è­·çš„-api">å—ä¿è­·çš„ api</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#75715e">// ProfilesIndex.jsxã€ProfilesNew.jsxã€ProfilesEdit.jsxã€ProfilesShow.jsx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// çœç•¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// åŠ å…¥ç¨‹å¼ç¢¼æœ‰è¨»è§£çš„åœ°æ–¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">useEffect</span>(() =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fetchProfiles</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">token</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">localStorage</span>.<span style="color:#a6e22e">getItem</span>(<span style="color:#e6db74">&#39;accessToken&#39;</span>) <span style="color:#75715e">// å¾ localStorage å–å‡º accessTokenï¼ŒaccessToken æ˜¯ç”¨æˆ¶ç™»å…¥æ™‚å¾Œç«¯ç™¼é€çš„é©—è­‰æ†‘è­‰ï¼Œæœƒåœ¨è«‹æ±‚æ™‚æä¾›çµ¦å¾Œç«¯ä¾†ç¢ºèªç”¨æˆ¶èº«ä»½ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;/api/profiles/&#39;</span>, {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;GET&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;application/json&#39;</span>, <span style="color:#75715e">//Content-Type&#39;: &#39;application/json&#39;å‘Šè¨´ä¼ºæœå™¨ æˆ‘å€‘é æœŸå›å‚³ JSON è³‡æ–™ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>          <span style="color:#a6e22e">Authorization</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`Bearer </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">token</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>, <span style="color:#75715e">//é€™æ˜¯èº«ä»½é©—è­‰æ¨™é ­ï¼ˆAuthorization Headerï¼‰ï¼Œç”¨ä¾†å‘Šè¨´ä¼ºæœå™¨ Authorization: Bearer &lt;ä½ çš„ accessToken&gt;ã€‚é€™æ¨£ä¼ºæœå™¨å°±èƒ½è­˜åˆ¥è«‹æ±‚ä¾†è‡ªå“ªå€‹ä½¿ç”¨è€…ï¼Œä¸¦ç¢ºä¿é€™å€‹ä½¿ç”¨è€…æœ‰æ¬Šé™å­˜å– /api/profiles/ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        },
</span></span><span style="display:flex;"><span>      })
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">ok</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#39;å–å¾— Profiles å¤±æ•—&#39;</span>)
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">json</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">setProfiles</span>(<span style="color:#a6e22e">data</span>)
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">err</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">setError</span>(<span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">message</span>)
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">finally</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">setLoading</span>(<span style="color:#66d9ef">false</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fetchProfiles</span>()
</span></span><span style="display:flex;"><span>}, [])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">loading</span>) <span style="color:#66d9ef">return</span> &lt;<span style="color:#f92672">div</span>&gt;<span style="color:#a6e22e">è¼‰å…¥ä¸­</span>...&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">error</span>) <span style="color:#66d9ef">return</span> &lt;<span style="color:#f92672">div</span>&gt;Error<span style="color:#f92672">:</span> {<span style="color:#a6e22e">error</span>}&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">profiles</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">===</span> <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span> &lt;<span style="color:#f92672">div</span>&gt;<span style="color:#a6e22e">ç›®å‰æ²’æœ‰ä»»ä½•</span> <span style="color:#a6e22e">Profile</span> <span style="color:#a6e22e">è³‡æ–™</span>&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">ProfileIndex</span>
</span></span></code></pre></div><ul class="pa0">
  
   <li class="list di">
     <a href="/lioouzzz/sleepblog.git/tags/python/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Python</a>
   </li>
  
   <li class="list di">
     <a href="/lioouzzz/sleepblog.git/tags/vite&#43;react/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Vite&#43;React</a>
   </li>
  
   <li class="list di">
     <a href="/lioouzzz/sleepblog.git/tags/api/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">API</a>
   </li>
  
   <li class="list di">
     <a href="/lioouzzz/sleepblog.git/tags/drf/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">DRF</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">æ–‡ç« ç›®éŒ„</p>
      <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#å¾Œç«¯å»ºç«‹-api">å¾Œç«¯å»ºç«‹ API</a></li>
        <li><a href="#å‰ç«¯ä¸²æ¥-api">å‰ç«¯ä¸²æ¥ API</a></li>
        <li><a href="#å¢åŠ -jwt-èªè­‰">å¢åŠ  JWT èªè­‰</a></li>
        <li><a href="#å‰ç«¯-token-è¨­ç½®">å‰ç«¯ token è¨­ç½®</a></li>
        <li><a href="#å—ä¿è­·çš„-api">å—ä¿è­·çš„ api</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</aside>

  </article>

    </main>
    
  <footer
    class="bottom-0 w-100 pa3"
    role="contentinfo"
    style="background: url('/lioouzzz/sleepblog.git/images/cover_image.png') no-repeat center/cover;"
  >
    <div class="flex justify-between">
      <a
        class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3"
        href="http://localhost:1313/lioouzzz/sleepblog.git/"
      >
        &copy;  ğŸ€ğŸ€ğŸ€
        2025 
      </a>
      <div><div class="ananke-socials"></div>
</div>
    </div>
  </footer>

  </body>
</html>

<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/lioouzzz/sleepblog.git/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=lioouzzz/sleepblog.git/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>djangoä¸²æ¥googleç¬¬ä¸‰æ–¹ç™»å…¥ | ğŸ€ğŸ€ğŸ€</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="è©³ç´°çš„åƒè€ƒæ–‡ä»¶(Document)å¯ä»¥å‰å¾€ Django Package å®˜ç¶²
django-allauth
é¦–å…ˆå…ˆå®‰è£å¥—ä»¶
pip install django-allauth
">
    <meta name="generator" content="Hugo 0.138.0">
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/lioouzzz/sleepblog.git/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/lioouzzz/sleepblog.git/posts/1214googlelogin/1214googlelogin/">
    

    <meta property="og:url" content="http://localhost:1313/lioouzzz/sleepblog.git/posts/1214googlelogin/1214googlelogin/">
  <meta property="og:site_name" content="ğŸ€ğŸ€ğŸ€">
  <meta property="og:title" content="djangoä¸²æ¥googleç¬¬ä¸‰æ–¹ç™»å…¥">
  <meta property="og:description" content="è©³ç´°çš„åƒè€ƒæ–‡ä»¶(Document)å¯ä»¥å‰å¾€ Django Package å®˜ç¶² django-allauth
é¦–å…ˆå…ˆå®‰è£å¥—ä»¶
pip install django-allauth">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-12-14T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-12-14T00:00:00+00:00">

  <meta itemprop="name" content="djangoä¸²æ¥googleç¬¬ä¸‰æ–¹ç™»å…¥">
  <meta itemprop="description" content="è©³ç´°çš„åƒè€ƒæ–‡ä»¶(Document)å¯ä»¥å‰å¾€ Django Package å®˜ç¶² django-allauth
é¦–å…ˆå…ˆå®‰è£å¥—ä»¶
pip install django-allauth">
  <meta itemprop="datePublished" content="2024-12-14T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-12-14T00:00:00+00:00">
  <meta itemprop="wordCount" content="192">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="djangoä¸²æ¥googleç¬¬ä¸‰æ–¹ç™»å…¥">
  <meta name="twitter:description" content="è©³ç´°çš„åƒè€ƒæ–‡ä»¶(Document)å¯ä»¥å‰å¾€ Django Package å®˜ç¶² django-allauth
é¦–å…ˆå…ˆå®‰è£å¥—ä»¶
pip install django-allauth">

	
  </head><body class="ma0 avenir bg-near-white development">

    
   
  

  
  
  
  <header class="cover bg-center" style="background-image: url('http://localhost:1313/lioouzzz/sleepblog.git/images/ribbon%20candle.jpg');">
    <div class="bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/lioouzzz/sleepblog.git/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        <img src="/lioouzzz/sleepblog.git/images/20241130%20%e5%80%8b%e4%ba%balogo2.png" class="w100 mw5-ns" alt="ğŸ€ğŸ€ğŸ€" />
      
    </a>
    <div class="flex-l items-center">
      

      
      <div class="ananke-socials"></div>

    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <div class="f2 f1-l fw2 white-90 mb0 lh-title">djangoä¸²æ¥googleç¬¬ä¸‰æ–¹ç™»å…¥</div>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">djangoä¸²æ¥googleç¬¬ä¸‰æ–¹ç™»å…¥</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2024-12-14T00:00:00Z">December 14, 2024</time>
      

      
      
        <span class="f6 mv4 dib tracked"> - One minute read </span>
        <span class="f6 mv4 dib tracked"> - 192 words </span>
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>è©³ç´°çš„åƒè€ƒæ–‡ä»¶(Document)å¯ä»¥å‰å¾€ Django Package å®˜ç¶²
<a href="https://docs.allauth.org/en/dev/socialaccount/providers/google.html">django-allauth</a></p>
<p>é¦–å…ˆå…ˆå®‰è£å¥—ä»¶</p>
<pre tabindex="0"><code class="language-terminal" data-lang="terminal">pip install django-allauth
</code></pre><p>å®‰è£å®Œæˆå¾Œï¼Œé–‹å•Ÿ Django å°ˆæ¡ˆçš„ settings.pyï¼Œåœ¨ INSTALL_APPS ä¸­ï¼ŒåŠ å…¥ allauth å¥—ä»¶åŠæ‰€éœ€çš„ç¬¬ä¸‰æ–¹ç™»å…¥é©—è­‰æä¾›è€…(provider)ï¼Œå…¶ä¸­çš„ SITE_ID ç‚ºç¶²ç«™ IDï¼Œè‡ªè¡Œå®šç¾©å³å¯ã€‚
å¦‚ä¸‹ç¯„ä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>INSTALLED_APPS <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.admin&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.auth&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.contenttypes&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.sessions&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.messages&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.staticfiles&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.sites&#34;</span>,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#allauth</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;allauth&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;allauth.account&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;allauth.socialaccount&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># google provider</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;allauth.socialaccount.providers.google&#34;</span>,
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e">#settings.py</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SITE_ID <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e">#settings.py</span>
</span></span><span style="display:flex;"><span>MIDDLEWARE <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.middleware.security.SecurityMiddleware&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.sessions.middleware.SessionMiddleware&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.middleware.common.CommonMiddleware&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.middleware.csrf.CsrfViewMiddleware&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.auth.middleware.AuthenticationMiddleware&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.messages.middleware.MessageMiddleware&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.middleware.clickjacking.XFrameOptionsMiddleware&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;allauth.account.middleware.AccountMiddleware&#34;</span>,  <span style="color:#75715e"># allauth</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#å¤šç«™é»æ‡‰ç”¨ã€å–®ç«™é»æ‡‰ç”¨ã€æ¸¬è©¦è·³è½‰åŠŸèƒ½</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>SOCIALACCOUNT_PROVIDERS <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;google&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;APPS&#34;</span>: [
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;client_id&#34;</span>: env(<span style="color:#e6db74">&#34;GMAIL_CLIENT_ID&#34;</span>),  <span style="color:#75715e">#apiç²å¾—çš„cliend_idä½¿ç”¨envä¿ç®¡</span>
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;secret&#34;</span>: env(<span style="color:#e6db74">&#34;GMAIL_API_SECRET&#34;</span>), <span style="color:#75715e">#apiç²å¾—çš„secretä½¿ç”¨envä¿ç®¡</span>
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;settings&#34;</span>: {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;scope&#34;</span>: [   <span style="color:#75715e">#è«‹æ±‚çš„æ¬Šé™ç¯„åœ</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#e6db74">&#34;profile&#34;</span>,
</span></span><span style="display:flex;"><span>                        <span style="color:#e6db74">&#34;email&#34;</span>,
</span></span><span style="display:flex;"><span>                    ],
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;auth_params&#34;</span>: {
</span></span><span style="display:flex;"><span>                        <span style="color:#e6db74">&#34;access_type&#34;</span>: <span style="color:#e6db74">&#34;online&#34;</span>,  <span style="color:#75715e">#æŒ‡å®šä½¿ç”¨åœ¨ç·šæˆæ¬Šæ¨¡å¼ï¼Œä¸æ¶‰åŠé›¢ç·šï¼ˆå³ä¸éœ€è¦åˆ·æ–°ä»¤ç‰Œï¼‰ã€‚</span>
</span></span><span style="display:flex;"><span>                    },
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;redirect_uri&#34;</span>: <span style="color:#e6db74">&#34;http://127.0.0.1:8000/accounts/google/login/callback/&#34;</span>,  <span style="color:#75715e">#ç•¶ Google å®Œæˆé©—è­‰å¾Œï¼Œé‡å®šå‘å›æ‡‰ç”¨çš„ URLã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                },
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e">#settings.py</span>
</span></span><span style="display:flex;"><span>AUTHENTICATION_BACKENDS <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;django.contrib.auth.backends.ModelBackend&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;allauth.account.auth_backends.AuthenticationBackend&#34;</span>,
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p><code>AUTHENTICATION_BACKENDS</code> æ˜¯ç”¨ä¾†é…ç½®é©—è­‰å¾Œç«¯çš„è¨­ç½®ï¼Œå®šç¾©äº† Django å¦‚ä½•è™•ç†ç”¨æˆ¶çš„èº«ä»½é©—è­‰è«‹æ±‚ã€‚</p>
<ul>
<li>
<p><code>ModelBackend</code> æ˜¯ Django çš„é»˜èªé©—è­‰å¾Œç«¯ï¼Œè² è²¬è™•ç†åŸºæ–¼ç”¨æˆ¶æ¨¡å‹ï¼ˆUser æ¨¡å‹ï¼‰çš„åŸºæœ¬èº«ä»½é©—è­‰é‚è¼¯ã€‚</p>
</li>
<li>
<p><code>allauth.account.auth_backends.AuthenticationBackend</code> æä¾›çš„é©—è­‰å¾Œç«¯ï¼Œç”¨æ–¼è™•ç†ç¤¾äº¤å¸³è™Ÿç™»éŒ„ï¼ˆä¾‹å¦‚ Googleã€Facebook ç­‰ç¬¬ä¸‰æ–¹ç™»éŒ„ï¼‰å’ŒåŸºæ–¼é›»å­éƒµä»¶çš„
é©—è­‰é‚è¼¯ã€‚</p>
<p>1.ç¤¾äº¤å¸³è™Ÿæ”¯æŒ<br>
2.é›»å­éƒµä»¶èªè­‰<br>
3.è‡ªå‹•å‰µå»ºç”¨æˆ¶(ç•¶ä½¿ç”¨ç¤¾äº¤å¸³è™Ÿç™»éŒ„ä¸”ç”¨æˆ¶ä¸å­˜åœ¨æ™‚ï¼Œallauth æœƒè‡ªå‹•å‰µå»ºä¸€å€‹æ–°çš„ç”¨æˆ¶ã€‚)</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e">#settings.py</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Allauth è¨­ç½®</span>
</span></span><span style="display:flex;"><span>SOCIALACCOUNT_LOGIN_ON_GET <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>  <span style="color:#75715e">#ç”¨æˆ¶å®Œæˆç¤¾äº¤å¸³è™Ÿèªè­‰å¾Œï¼Œç›´æ¥ç™»éŒ„ï¼Œçœç•¥ç¢ºèªé é¢ã€‚</span>
</span></span><span style="display:flex;"><span>ACCOUNT_EMAIL_REQUIRED <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>  <span style="color:#75715e">#è¨»å†Šæ™‚å¿…é ˆæä¾›é›»å­éƒµä»¶ã€‚</span>
</span></span><span style="display:flex;"><span>ACCOUNT_UNIQUE_EMAIL <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>  <span style="color:#75715e">#æ¯å€‹é›»å­éƒµä»¶åœ°å€å¿…é ˆå”¯ä¸€ã€‚</span>
</span></span><span style="display:flex;"><span>ACCOUNT_AUTHENTICATION_METHOD <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;email&#34;</span>  <span style="color:#75715e">#ç”¨æˆ¶åªèƒ½é€šéé›»å­éƒµä»¶ç™»éŒ„ï¼Œç¦ç”¨ç”¨æˆ¶åç™»éŒ„ã€‚</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>LOGIN_REDIRECT_URL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/&#34;</span>  <span style="color:#75715e"># ç™»å…¥å¾Œçš„é¦–é ç¶²å€</span>
</span></span></code></pre></div><p>urls.py æ–°å¢ path
<img src="path.png" alt="path"></p>
<h4 id="google-api">Google api</h4>
<p>é¦–å…ˆåˆ° google cloud<br>
å»ºç«‹å°ˆæ¡ˆ</p>
<p>æœå°‹ gmail&ndash;&gt;å•Ÿç”¨ &ndash;&gt;å»ºç«‹æ†‘è­‰
ä¹‹å¾Œé–‹å§‹å¡«å¯«æ†‘è­‰è³‡è¨Š</p>
<p>æŠŠæ†‘è­‰ Oauth Client IDS è£¡é¢çš„è³‡æ–™ï¼ŒæŠŠé€™äº›è³‡æ–™æ”¾ <code>settings.py</code>çš„ SOCIALACCOUNT_PROVIDERS çš„ client_IDã€secret æ¬„ä½ï¼Œè¦è¨˜å¾—åœ¨.env åŠ å¯†ä¿ç®¡</p>
<p>è©³ç´°æ­¥é©Ÿè«‹çœ‹å½±ç‰‡
<a href="https://youtu.be/LyDdfO6o_G4?si=y9YVgIeLSSSvmHab"><img src="https://img.youtube.com/vi/LyDdfO6o_G4/0.jpg" alt="googleapiå½±ç‰‡"></a></p>
<p>è¦æ³¨æ„çš„æ˜¯ï¼Œé‡æ–°å°å‘ url
<img src="%E7%B7%A8%E8%BC%AFurl.png" alt="å°å›è·¯å¾‘"></p>
<p>æ¥è‘—ï¼Œå›åˆ° Django Administration(ç®¡ç†å“¡å¾Œå°)é¦–é ï¼Œé¸æ“‡ã€ŒSitesã€è³‡æ–™æ¨¡å‹ï¼Œå°‡ example.com ä¿®æ”¹ç‚ºè‡ªå·±çš„ç¶²ç«™ï¼Œç”±æ–¼æœ¬æ–‡ä»¥æœ¬åœ°ç«¯ä¼ºæœå™¨ä¾†åŸ·è¡Œï¼Œæ‰€ä»¥ä¿®æ”¹çš„å…§å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjYforCKVncIh1L6Ijb0ilz36FdGE9TMTITktDwnT5Yl-Hos5xkKr_RB-Wzmyei-kbLOowApc1xA8h49yAEMTr0vj59nK8u5QD0ASf8_RPYgfzUXkZ2cNaB4HnyBEPdLDhzS_LjUmU3bJre/s1600/django_allauth.PNG" alt="django å¾Œå° site "></p>
<p><img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhu9EImEGa2sd8ovon2FP9MxKKqW8rjsqd0gQZYgsupHWgXPfJ3JlJwmyCzuHkDf2YG_3YYcGY46o19L33kE89Lbf-9RAutOpAnlGZgkLXBTXd0p0jwK6d6qbERk4Akr1fYDm1_CCGFNnRJ/s1600/django_allauth_google.PNG" alt="django å¾Œå° social application google login"></p>
<p>Client idã€Secret key éƒ½å¯ä»¥åœ¨ google cloud å‰›å‰›è¼¸å…¥çš„æ†‘è­‰å¾—åˆ°ã€‚</p>
<p>å›åˆ° templates æ¨£æ¿ ä¿®æ”¹
<img src="templates.png" alt="templates"></p><ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-washed-green bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/lioouzzz/sleepblog.git/" >
    &copy;  ğŸ€ğŸ€ğŸ€ 2025 
  </a>
    <div><div class="ananke-socials"></div>
</div>
  </div>
</footer>


  </body>
</html>
